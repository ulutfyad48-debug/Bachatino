<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bachatino ¬∑ smart mart</title>
  
  <!-- Font Awesome & Inter font -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,600;14..32,700;14..32,800&display=swap" rel="stylesheet">
  
  <style>
    /* --- modern reset & base --- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
    }

    body {
      background: #f4f7fc;
      color: #1e2f3e;
      line-height: 1.5;
    }

    /* --- glass header --- */
    .header {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(16px) saturate(180%);
      -webkit-backdrop-filter: blur(16px);
      padding: 0.9rem 2rem;
      position: sticky;
      top: 0;
      z-index: 120;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1.2rem;
      border-bottom: 1px solid rgba(0,60,40,0.08);
      box-shadow: 0 6px 24px -12px rgba(0,60,30,0.12);
    }

    .logo {
      font-weight: 800;
      font-size: 1.9rem;
      letter-spacing: -0.03em;
      background: linear-gradient(145deg, #0a3529, #1f6d51);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .logo i {
      background: #0f4032;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 2.1rem;
    }

    /* --- search --- */
    .search-group {
      flex: 1;
      max-width: 440px;
      position: relative;
    }
    .search-group i {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: #6a7e94;
      font-size: 1.1rem;
      pointer-events: none;
    }
    .search-input {
      width: 100%;
      padding: 1rem 1.2rem 1rem 3.5rem;
      border: 1.5px solid #dee9f2;
      border-radius: 48px;
      font-size: 0.95rem;
      background: white;
      transition: all 0.2s ease;
      box-shadow: 0 3px 12px rgba(0,0,0,0.02);
    }
    .search-input:focus {
      outline: none;
      border-color: #1f6d51;
      box-shadow: 0 8px 22px -12px #1b6b4f;
    }

    /* --- category chips (unique) --- */
    .category-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.7rem;
      padding: 1.2rem 2rem 0.2rem 2rem;
      max-width: 1400px;
      margin: 0 auto;
    }
    .cat-chip {
      background: white;
      border: 1px solid #dde7f0;
      padding: 0.6rem 1.8rem;
      border-radius: 60px;
      font-weight: 600;
      font-size: 0.9rem;
      color: #2b4b5c;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.2,0.9,0.3,1.1);
      box-shadow: 0 4px 12px rgba(0,0,0,0.02);
      letter-spacing: -0.01em;
    }
    .cat-chip i {
      margin-right: 6px;
      font-size: 0.8rem;
      color: #1f6d51;
    }
    .cat-chip.active {
      background: #1f6d51;
      border-color: #1f6d51;
      color: white;
      box-shadow: 0 10px 18px -8px #166b4b;
    }
    .cat-chip.active i { color: white; }
    .cat-chip:hover {
      background: #e3f3ec;
      border-color: #9fc7b5;
      transform: translateY(-2px);
    }

    /* --- product grid (neumorph‚Äësoft) --- */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 2rem;
      padding: 2rem 2rem 3rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    .card {
      background: white;
      border-radius: 28px;
      padding: 1.5rem 1.3rem;
      box-shadow: 0 18px 35px -12px rgba(0,40,30,0.08), 0 2px 8px rgba(0,0,0,0.02);
      transition: transform 0.25s, box-shadow 0.3s;
      display: flex;
      flex-direction: column;
      border: 1px solid rgba(255,255,255,0.7);
      position: relative;
    }
    .card:hover {
      transform: translateY(-8px) scale(1.01);
      box-shadow: 0 28px 48px -18px #0b4635;
    }

    /* out-of-stock specific */
    .card.out-of-stock {
      opacity: 0.7;
      pointer-events: none;
    }
    .card.out-of-stock img {
      filter: grayscale(1);
    }
    .stock-badge {
      position: absolute;
      top: 20px; right: 20px;
      background: #e74c3c;
      color: white;
      padding: 0.4rem 1.2rem;
      border-radius: 60px;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.02em;
      z-index: 15;
      box-shadow: 0 6px 18px rgba(231,76,60,0.3);
      display: none;
    }
    .card.out-of-stock .stock-badge {
      display: inline-block;
    }

    .card img {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 20px;
      background: #f0f5fa;
      margin-bottom: 1.2rem;
      border: 1px solid #eaf0f5;
    }

    .product-cat {
      display: inline-block;
      background: #eaf3ee;
      padding: 0.2rem 1.2rem;
      border-radius: 40px;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      color: #1f6d51;
      margin-bottom: 0.7rem;
      border: 1px solid #c6e2d4;
      width: fit-content;
    }

    .card h4 {
      font-size: 1.45rem;
      font-weight: 800;
      color: #132e3c;
      margin-bottom: 0.3rem;
      letter-spacing: -0.02em;
    }

    .card p {
      color: #4a6172;
      font-size: 0.9rem;
      margin-bottom: 0.8rem;
      line-height: 1.4;
      flex-grow: 1;
    }

    .price {
      font-weight: 800;
      font-size: 1.6rem;
      color: #0e4f37;
      margin: 0.5rem 0 1rem;
    }

    /* quantity pill */
    .qty-pill {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #f2f8fc;
      border-radius: 48px;
      padding: 5px;
      border: 1px solid #d6e5f0;
      margin-top: 8px;
    }
    .qty-pill button {
      width: 44px;
      height: 44px;
      border: none;
      background: white;
      border-radius: 50%;
      font-size: 1.6rem;
      font-weight: 600;
      color: #1b4d3a;
      cursor: pointer;
      box-shadow: 0 5px 14px rgba(0,0,0,0.03);
      transition: 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .qty-pill button:hover {
      background: #1f6d51;
      color: white;
      transform: scale(1.08);
      box-shadow: 0 8px 18px #1d6e4e70;
    }
    .qty-pill span {
      font-weight: 700;
      font-size: 1.2rem;
      min-width: 40px;
      text-align: center;
      color: #1f3e4a;
    }

    /* floating cart ‚Äì premium */
    .float-cart {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: linear-gradient(145deg, #0e4f37, #1b7855);
      width: 75px;
      height: 75px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.1rem;
      color: white;
      box-shadow: 0 25px 45px -12px #0a3d2b;
      cursor: pointer;
      transition: 0.3s cubic-bezier(0.2, 1, 0.3, 1);
      border: 4px solid rgba(255,255,255,0.2);
      z-index: 99;
    }
    .float-cart:hover {
      transform: scale(1.1) rotate(-3deg);
      background: #1f6d51;
    }
    .cart-badge {
      position: absolute;
      top: 0;
      right: 0;
      background: #dc2626;
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      font-size: 0.8rem;
      font-weight: 800;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 3px solid white;
      transform: translate(6px, -6px);
      opacity: 0;
      transition: 0.2s;
      box-shadow: 0 4px 12px black(0,0,0,0.2);
    }

    /* --- popup (no default delivery) --- */
    .popup-overlay {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(10, 30, 25, 0.6);
      backdrop-filter: blur(8px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 220;
      opacity: 0;
      transition: opacity 0.25s;
    }
    .popup-overlay.active {
      opacity: 1;
    }
    .popup-card {
      background: white;
      width: 94%;
      max-width: 540px;
      max-height: 90vh;
      overflow-y: auto;
      padding: 2.2rem 2.2rem;
      border-radius: 42px;
      box-shadow: 0 50px 90px -30px #0f2f24;
      animation: slidePop 0.35s ease-out;
    }
    @keyframes slidePop {
      0% { opacity: 0; transform: scale(0.92) translateY(25px); }
      100% { opacity: 1; transform: scale(1) translateY(0); }
    }

    .popup-card h3 {
      font-size: 2rem;
      font-weight: 800;
      margin-bottom: 1.5rem;
      color: #0a382b;
      text-align: center;
    }

    .field {
      margin-bottom: 1.4rem;
    }
    .field label {
      display: block;
      font-weight: 600;
      color: #3a5568;
      margin-bottom: 0.3rem;
      margin-left: 0.5rem;
      font-size: 0.9rem;
    }
    .popup-card input, .popup-card select, .popup-card textarea {
      width: 100%;
      padding: 1.1rem 1.4rem;
      border: 2px solid #e4eef5;
      border-radius: 30px;
      font-size: 0.95rem;
      background: #fafdff;
      transition: 0.2s;
      outline: none;
      color: #1a3545;
      font-weight: 500;
    }
    .popup-card select {
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%233f5568" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>');
      background-repeat: no-repeat;
      background-position: right 1.5rem center;
      background-size: 1.2rem;
    }
    .popup-card textarea {
      min-height: 100px;
      border-radius: 30px;
    }
    .popup-card input:focus, .popup-card select:focus, .popup-card textarea:focus {
      border-color: #1f6d51;
      background: white;
      box-shadow: 0 0 0 5px #d7f0e7;
    }

    .total-row {
      background: #ecfbf3;
      border-radius: 30px;
      padding: 1.4rem 1.8rem;
      margin: 1.8rem 0 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid #bfead8;
      color: #0e543b;
    }
    .total-row span:first-child {
      font-weight: 700;
      font-size: 1.1rem;
    }
    .total-row span:last-child {
      font-size: 1.9rem;
      font-weight: 800;
    }

    .action-btns {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .btn-wa, .btn-email {
      border: none;
      padding: 1.2rem;
      border-radius: 40px;
      font-size: 1.1rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      color: white;
      cursor: pointer;
      transition: 0.25s;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .btn-wa { background: linear-gradient(135deg, #20b573, #12874a); box-shadow: 0 16px 28px -10px #1e9b58; }
    .btn-email { background: linear-gradient(135deg, #3f82f0, #2550bb); box-shadow: 0 16px 28px -10px #2c62d4; }
    .btn-wa:hover, .btn-email:hover { transform: translateY(-4px); filter: brightness(1.05); }

    .btn-cancel {
      background: transparent;
      border: none;
      color: #7b95ab;
      font-weight: 600;
      padding: 1rem;
      border-radius: 40px;
      cursor: pointer;
      margin-top: 0.5rem;
    }
    .btn-cancel:hover { background: #ecf2f9; color: #254150; }

    footer {
      text-align: center;
      padding: 2rem 1rem 1.2rem;
      color: #7f99b0;
      border-top: 1px solid #e3eef9;
      background: #f8fcff;
    }
    .footer-contact {
      margin-top: 1rem;
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
    }
    .footer-contact a {
      color: #1f6d51;
      text-decoration: none;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: 0.2s;
    }
    .footer-contact a:hover {
      color: #0b4635;
      transform: scale(1.05);
    }
    .no-products {
      grid-column: 1/-1;
      text-align: center;
      padding: 4rem;
      color: #809aaf;
      font-weight: 500;
    }
  </style>
</head>
<body>

<header class="header">
  <div class="logo"><i class="fas fa-basket-shopping"></i> Bachatino</div>
  <div class="search-group">
    <i class="fas fa-search"></i>
    <input type="text" id="searchField" class="search-input" placeholder="Juice, rice, oil...">
  </div>
</header>

<!-- category chips (dynamic) -->
<div class="category-bar" id="categoryContainer"></div>

<!-- product grid -->
<div class="products-grid" id="productGrid"></div>

<!-- floating cart -->
<div class="float-cart" onclick="openOrderPopup()">
  <i class="fas fa-shopping-bag"></i>
  <span class="cart-badge" id="cartCounter">0</span>
</div>

<!-- order popup (no default delivery) -->
<div class="popup-overlay" id="orderPopup">
  <div class="popup-card">
    <h3>üõí complete order</h3>

    <div class="field">
      <label>Full name</label>
      <input type="text" id="fullName" placeholder="e.g. Kamran Khan">
    </div>
    <div class="field">
      <label>Phone / WhatsApp</label>
      <input type="tel" id="mobileNo" placeholder="0312 3456789">
    </div>

    <!-- NO DEFAULT SELECTED (important) -->
    <div class="field">
      <label>Delivery method *</label>
      <select id="deliverySelect">
        <option value="" disabled selected>‚Äî select delivery option ‚Äî</option>
        <option value="pickup">üì¶ Pickup (free) ‚Äì Tarnab Farm, Peshawar, Mohalla Yakub Khan (near Abubakar Masjid)</option>
        <option value="peshawar">üöö Peshawar city ‚Äì Rs 99</option>
        <option value="kpk">üõµ KPK (other cities) ‚Äì Rs 100</option>
        <option value="other">üöõ Other provinces ‚Äì Rs 150</option>
      </select>
    </div>

    <div class="field">
      <label>Full address (required if delivery)</label>
      <textarea id="addressField" placeholder="House 12, Street 5, Gulbahar ..."></textarea>
    </div>

    <div class="total-row">
      <span>Total amount</span>
      <span id="totalAmountSpan">Rs 0</span>
    </div>

    <div class="action-btns">
      <button class="btn-wa" onclick="submitOrder('whatsapp')"><i class="fab fa-whatsapp"></i> WhatsApp order</button>
      <button class="btn-email" onclick="submitOrder('email')"><i class="fas fa-envelope"></i> Email order</button>
      <button class="btn-cancel" onclick="closePopup()">‚Üê continue shopping</button>
    </div>
  </div>
</div>

<footer>
  <p>¬© 2024 Bachatino ¬∑ fresh & honest prices</p>
  <div class="footer-contact">
    <a href="tel:+923125540048"><i class="fas fa-phone-alt"></i> +92 312 5540048</a>
    <a href="mailto:ullahyad199@gmail.com"><i class="fas fa-envelope"></i> ullahyad199@gmail.com</a>
  </div>
</footer>

<script>
  (function() {
    // ----- PRODUCT DATA (with categories & out‚Äëof‚Äëstock flag) -----
   const PRODUCTS = [
  {
    id: 1,
    title: "English Comprehensive Notes 10",
    category: "10th-grade-english",
    catLabel: "üìò 10th Grade English",
    description: "High-quality exam notes for 10th Grade. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1524995997946-a1c2e315a42f?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 2,
    title: "Biology Comprehensive Notes 10",
    category: "10th-grade-biology",
    catLabel: "üß¨ 10th Grade Biology",
    description: "Detailed Biology guide with solved exercises. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1532012197267-da84d127e765?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 3,
    title: "Chemistry Islamia Notes 10",
    category: "10th-grade-chemistry",
    catLabel: "‚öóÔ∏è 10th Grade Chemistry",
    description: "Comprehensive Chemistry notes for new syllabus. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1507842217343-583bb7270b66?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 4,
    title: "Unique Professor Physics 9",
    category: "9th-grade-physics",
    catLabel: "üî¨ 9th Grade Physics",
    description: "Physics guide with MCQs and model papers. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1495446815901-a7297e633e8d?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 5,
    title: "Chemistry Comprehensive Notes 9",
    category: "9th-grade-chemistry",
    catLabel: "‚öóÔ∏è 9th Grade Chemistry",
    description: "Complete 9th Grade Chemistry exam preparation notes. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 6,
    title: "Unique Professor English 9",
    category: "9th-grade-english",
    catLabel: "üìò 9th Grade English",
    description: "3-in-1 Grammar and Translation guide for 9th Grade. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1491841573634-28140fc7ced7?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 7,
    title: "Pakistan Studies (Millat Guide)",
    category: "degree-pak-studies",
    catLabel: "üìú Degree Pak Studies",
    description: "Advanced Pakistan Studies guide for Degree classes. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1589829085413-56de8ae18c73?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 8,
    title: "Islamiat Lazmi Notes",
    category: "9th-10th-islamiat",
    catLabel: "üïå Islamiat (9th & 10th)",
    description: "Simplified Islamic Studies notes for KPK Board. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1585664811087-47f65abbad66?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 9,
    title: "Pakistan Studies (Islamia Notes)",
    category: "9th-10th-pak-studies",
    catLabel: "üìú Pak Studies (9th & 10th)",
    description: "Concise Pakistan Studies notes for exam success. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1598618443855-232ee0f819f6?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 10,
    title: "Model Guide 8 (Multi-Subject)",
    category: "8th-grade-general",
    catLabel: "üìö 8th Grade General",
    description: "All-in-one guide for 8th Grade subjects. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1512820790803-83ca734da794?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 11,
    title: "Physics (Comprehensive Notes) 9th",
    category: "9th-grade-physics",
    catLabel: "üî¨ 9th Grade Physics",
    description: "Comprehensive Physics notes for 9th grade by Nayab/Prof. Abdur Rahim. Features solved examples & assignments. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1589998059171-988d887df646?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 12,
    title: "Physics (Unique Professor) 10th",
    category: "10th-grade-physics",
    catLabel: "üî¨ 10th Grade Physics",
    description: "Physics guide for 10th grade by Unique Publishers. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1506880018603-83d5b814b5a6?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 13,
    title: "Physics (Comprehensive Notes) 10th",
    category: "10th-grade-physics",
    catLabel: "üî¨ 10th Grade Physics",
    description: "Comprehensive Physics notes for 10th grade by Nayab/Prof. Abdur Rahim. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1613896527026-f195d5c818ed?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 14,
    title: "Physics (New Course 2019) 10th",
    category: "10th-grade-physics",
    catLabel: "üî¨ 10th Grade Physics",
    description: "Physics New Course 2019 for 10th grade by Islamia/Malik Ahmad. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 15,
    title: "Chemistry (Notes - SLO Based) 10th",
    category: "10th-grade-chemistry",
    catLabel: "‚öóÔ∏è 10th Grade Chemistry",
    description: "Chemistry Notes SLO Based for 10th grade by Talent/Haseeb Ahsan Khan. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1532634993-15f421e42ec0?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 16,
    title: "Chemistry (New Edition) 10th",
    category: "10th-grade-chemistry",
    catLabel: "‚öóÔ∏è 10th Grade Chemistry",
    description: "Chemistry New Edition for 10th grade by Local Board/General. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 17,
    title: "Biology (Notes) 9th",
    category: "9th-grade-biology",
    catLabel: "üß¨ 9th Grade Biology",
    description: "Biology Notes for 9th grade by Shams Books Publisher. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1507413245164-6160d8298b31?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 18,
    title: "Biology (Notes - SLO Based) 10th",
    category: "10th-grade-biology",
    catLabel: "üß¨ 10th Grade Biology",
    description: "Biology Notes SLO Based for 10th grade by Nothing But Talent. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1576086213369-97a6d7970e7f?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 19,
    title: "English (Comprehensive Notes) 9th",
    category: "9th-grade-english",
    catLabel: "üìò 9th Grade English",
    description: "English Comprehensive Notes for 9th grade by Nayab/Qazi Ihsan Ullah. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 20,
    title: "New InterCom 3 (English)",
    category: "general-english",
    catLabel: "üìò General English",
    description: "New InterCom 3 English for General level by Language Programme. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1524995997946-a1c2e315a42f?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 21,
    title: "Physics (New Course) 9th",
    category: "9th-grade-physics",
    catLabel: "üî¨ 9th Grade Physics",
    description: "Physics New Course for 9th grade by Talent Publishers Peshawar. Authors: Atta Ur Rahman & Faiz Ul Qamar. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1583468323330-9032ad490fed?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 22,
    title: "Chemistry (Comprehensive Notes) 9th",
    category: "9th-grade-chemistry",
    catLabel: "‚öóÔ∏è 9th Grade Chemistry",
    description: "Chemistry Comprehensive Notes for 9th grade by Nayab/Syed Naseeb Zada. Exam-focused Theory & Notes. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1576086213369-97a6d7970e7f?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 23,
    title: "Biology (Comprehensive Notes) 9th",
    category: "9th-grade-biology",
    catLabel: "üß¨ 9th Grade Biology",
    description: "Biology Comprehensive Notes for 9th grade by Nayab/Manaris Khan. Long/Short Questions & Board Papers. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1585339145264-2d5679f12272?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 24,
    title: "English Grammar (Composition) 8th",
    category: "8th-grade-english",
    catLabel: "üìò 8th Grade English",
    description: "English Grammar Composition for 8th grade by Shauq Publications. New Scheme of Studies. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1456735190827-d1262f71b8a3?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 25,
    title: "Logarithmic Tables",
    category: "reference",
    catLabel: "üìä Logarithmic Tables",
    description: "Logarithmic Tables for Schools by MTP. Essential for Math & Physics. Previously used but in excellent condition. Only 1 copy available.",
    price: 20,
    image: "https://images.unsplash.com/photo-1554774853-719586f82d77?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  },
  {
    id: 26,
    title: "Physics (Additional Notes) 9th",
    category: "9th-grade-physics",
    catLabel: "üî¨ 9th Grade Physics",
    description: "Physics Additional Notes for 9th grade by Gravity Series/Nayab. Concept based notes. Previously used but in excellent condition. Only 1 copy available.",
    price: 100,
    image: "https://images.unsplash.com/photo-1465100906580-9f9f0b4c1e48?w=400&h=400&fit=crop&auto=format&q=80",
    inStock: true
  }
];
 const DELIVERY_FEES = { pickup:0, peshawar:99, kpk:100, other:150 };
    const WHATSAPP_NUMBER = "923125540048"; 
    const MERCHANT_EMAIL = "ullahyad199@gmail.com";

    // state
    let cart = {};                // id : qty
    let activeCategory = 'all';
    let currentSearch = '';

    // helpers
    function updateCartBadge() {
      const totalQty = Object.values(cart).reduce((s, v) => s + v, 0);
      const badge = document.getElementById('cartCounter');
      badge.innerText = totalQty;
      badge.style.opacity = totalQty > 0 ? '1' : '0';
    }

    // filter logic
    function getFilteredProducts() {
      let filtered = PRODUCTS;
      if (activeCategory !== 'all') {
        filtered = filtered.filter(p => p.category === activeCategory);
      }
      if (currentSearch.trim() !== '') {
        const term = currentSearch.toLowerCase();
        filtered = filtered.filter(p => p.title.toLowerCase().includes(term) || p.description.toLowerCase().includes(term));
      }
      return filtered;
    }

    // render everything
    function renderUI() {
      renderCategoryChips();
      const filtered = getFilteredProducts();
      renderProductGrid(filtered);
    }

    function renderCategoryChips() {
      const catMap = new Map();
      PRODUCTS.forEach(p => {
        if (!catMap.has(p.category)) {
          catMap.set(p.category, { label: p.catLabel, count: 0 });
        }
        catMap.get(p.category).count++;
      });

      let html = `<div class="cat-chip ${activeCategory === 'all' ? 'active' : ''}" data-cat="all"><i class="fas fa-grid-2"></i> All (${PRODUCTS.length})</div>`;
      for (let [key, val] of catMap.entries()) {
        html += `<div class="cat-chip ${activeCategory === key ? 'active' : ''}" data-cat="${key}">${val.label} (${val.count})</div>`;
      }
      document.getElementById('categoryContainer').innerHTML = html;

      // attach listeners
      document.querySelectorAll('.cat-chip').forEach(chip => {
        chip.addEventListener('click', (e) => {
          activeCategory = chip.dataset.cat;
          renderUI();
        });
      });
    }

    function renderProductGrid(products) {
      const grid = document.getElementById('productGrid');
      if (!products.length) {
        grid.innerHTML = `<div class="no-products"><i class="fas fa-box-open" style="font-size:2.5rem;"></i><p>No matching products</p></div>`;
        return;
      }

      let cards = '';
      products.forEach(p => {
        const qty = cart[p.id] || 0;
        const stockClass = p.inStock ? '' : 'out-of-stock';
        cards += `
          <div class="card ${stockClass}">
            <span class="stock-badge">OUT OF STOCK</span>
            <img src="${p.image}" alt="${p.title}" loading="lazy">
            <span class="product-cat">${p.catLabel}</span>
            <h4>${p.title}</h4>
            <p>${p.description}</p>
            <div class="price">Rs ${p.price}</div>
            <div class="qty-pill">
              <button onclick="adjustQty(${p.id}, -1)">‚àí</button>
              <span id="qty-${p.id}">${qty}</span>
              <button onclick="adjustQty(${p.id}, 1)">+</button>
            </div>
          </div>
        `;
      });
      grid.innerHTML = cards;
    }

    // global functions
    window.adjustQty = (id, delta) => {
      if (!cart[id]) cart[id] = 0;
      cart[id] = Math.max(0, cart[id] + delta);
      const span = document.getElementById(`qty-${id}`);
      if (span) span.innerText = cart[id];
      updateCartBadge();
    };

    // search
    document.getElementById('searchField').addEventListener('input', (e) => {
      currentSearch = e.target.value;
      renderUI();
    });

    // popup logic
    window.openOrderPopup = () => {
      const totalItems = Object.values(cart).reduce((a, b) => a + b, 0);
      if (totalItems === 0) {
        alert('Your cart is empty. Add some items.');
        return;
      }
      // reset fields (no default delivery)
      document.getElementById('deliverySelect').value = '';
      document.getElementById('fullName').value = '';
      document.getElementById('mobileNo').value = '';
      document.getElementById('addressField').value = '';
      calcTotalAndDisplay(); // subtotal only (fee 0)
      const pop = document.getElementById('orderPopup');
      pop.style.display = 'flex';
      setTimeout(() => pop.classList.add('active'), 10);
    };

    window.closePopup = () => {
      const pop = document.getElementById('orderPopup');
      pop.classList.remove('active');
      setTimeout(() => pop.style.display = 'none', 250);
    };

    function calcTotalAndDisplay() {
      const subtotal = PRODUCTS.reduce((sum, p) => sum + (p.price * (cart[p.id] || 0)), 0);
      const deliveryVal = document.getElementById('deliverySelect').value;
      const fee = (deliveryVal && DELIVERY_FEES.hasOwnProperty(deliveryVal)) ? DELIVERY_FEES[deliveryVal] : 0;
      const total = subtotal + fee;
      document.getElementById('totalAmountSpan').innerText = `Rs ${total}`;
      return { subtotal, fee, total, deliveryMethod: deliveryVal };
    }

    document.getElementById('deliverySelect').addEventListener('change', calcTotalAndDisplay);

    // submit order
    window.submitOrder = (method) => {
      const name = document.getElementById('fullName').value.trim();
      const phone = document.getElementById('mobileNo').value.trim();
      const delivery = document.getElementById('deliverySelect').value;
      const address = document.getElementById('addressField').value.trim();

      if (!name || !phone) {
        alert('Please fill name and phone number');
        return;
      }
      if (!delivery) {
        alert('Select a delivery method (pickup or paid)');
        return;
      }
      if (delivery !== 'pickup' && !address) {
        alert('Please enter full delivery address');
        return;
      }

      const cartItems = PRODUCTS.filter(p => cart[p.id] > 0);
      if (cartItems.length === 0) {
        alert('Cart is empty.');
        return;
      }

      const calc = calcTotalAndDisplay();
      const deliveryText = document.getElementById('deliverySelect').selectedOptions[0].text;

      let itemsList = cartItems.map(p => `‚Ä¢ ${p.title} x${cart[p.id]}  = Rs ${p.price * cart[p.id]}`).join('\n');

      let message = `üõí *Bachatino order*\nüë§ *Name:* ${name}\nüìû *Phone:* ${phone}\n\nüì¶ *Items:*\n${itemsList}\n-------------------\nSubtotal: Rs ${calc.subtotal}\nDelivery: ${deliveryText}\nüí∞ *TOTAL: Rs ${calc.total}*\n`;

      if (delivery === 'pickup') {
        // Updated pickup location with full address
        message += `üìç *Pickup:* Tarnab Farm, Peshawar, Mohalla Yakub Khan (near Abubakar Masjid)\n`;
      } else {
        message += `üè† *Address:* ${address}\n`;
      }

      if (method === 'whatsapp') {
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(message)}`, '_blank');
      } else {
        const subject = `New order from ${name}`;
        window.location.href = `mailto:${MERCHANT_EMAIL}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(message)}`;
      }
    };

    // initial render
    renderUI();
    updateCartBadge();
  })();
</script>

</body>
</html>